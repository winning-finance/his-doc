<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>winning-dll 组件 | HIS-前端开发手册</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/his-doc/favicon.ico">
    <meta name="description" content="">
    
    <link rel="preload" href="/his-doc/assets/css/0.styles.cdf22441.css" as="style"><link rel="preload" href="/his-doc/assets/js/app.2773af9d.js" as="script"><link rel="preload" href="/his-doc/assets/js/2.f33ebbea.js" as="script"><link rel="preload" href="/his-doc/assets/js/26.4369cb56.js" as="script"><link rel="prefetch" href="/his-doc/assets/js/10.09ac06b0.js"><link rel="prefetch" href="/his-doc/assets/js/11.3d229d7f.js"><link rel="prefetch" href="/his-doc/assets/js/12.91c2fdff.js"><link rel="prefetch" href="/his-doc/assets/js/13.69ee0054.js"><link rel="prefetch" href="/his-doc/assets/js/14.e75cf550.js"><link rel="prefetch" href="/his-doc/assets/js/15.ad59b1cc.js"><link rel="prefetch" href="/his-doc/assets/js/16.a5346ae4.js"><link rel="prefetch" href="/his-doc/assets/js/17.d0134f62.js"><link rel="prefetch" href="/his-doc/assets/js/18.e361b7a6.js"><link rel="prefetch" href="/his-doc/assets/js/19.020c1ae6.js"><link rel="prefetch" href="/his-doc/assets/js/20.2021117e.js"><link rel="prefetch" href="/his-doc/assets/js/21.c26195d5.js"><link rel="prefetch" href="/his-doc/assets/js/22.7ad2a222.js"><link rel="prefetch" href="/his-doc/assets/js/23.9eef5f5d.js"><link rel="prefetch" href="/his-doc/assets/js/24.42b7182b.js"><link rel="prefetch" href="/his-doc/assets/js/25.79820aae.js"><link rel="prefetch" href="/his-doc/assets/js/27.831f1e68.js"><link rel="prefetch" href="/his-doc/assets/js/3.435284fb.js"><link rel="prefetch" href="/his-doc/assets/js/4.d14089bb.js"><link rel="prefetch" href="/his-doc/assets/js/5.a2bfff00.js"><link rel="prefetch" href="/his-doc/assets/js/6.1f7a064d.js"><link rel="prefetch" href="/his-doc/assets/js/7.079b7eae.js"><link rel="prefetch" href="/his-doc/assets/js/8.6bab3532.js"><link rel="prefetch" href="/his-doc/assets/js/9.c1dcc7c6.js">
    <link rel="stylesheet" href="/his-doc/assets/css/0.styles.cdf22441.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><section><div><header class="doc-header"><h2 class="doc-header-logo"><a href="/his-doc/" class="router-link-active"><img src="/his-doc/assets/img/his.647a9dbf.svg" alt=""> <span>前端开发手册</span></a></h2> <ul class="doc-header-nav"><li class="doc-header-nav-item"><a href="/his-doc/guide/" class="doc-header-nav-item-link">
          指南
        </a></li><li class="doc-header-nav-item"><a href="/his-doc/tool/" class="doc-header-nav-item-link router-link-active">
          工具
        </a></li><li class="doc-header-nav-item"><a href="/his-doc/standard/" class="doc-header-nav-item-link">
          规范
        </a></li></ul></header></div> <main class="doc-main typo doc-main-md"><aside class="doc-aside"><ul class="doc-aside-nav"><li><a href="/his-doc/tool/" class="router-link-active">工具概览</a></li><li><a href="/his-doc/tool/his-cli.html">his-cli 脚手架</a></li><li><a href="/his-doc/tool/vue-cli-plugin-his.html">vue-cli 插件</a></li><li><a href="/his-doc/tool/winning-cookie-webpack-plugin.html">webpack 自动登陆插件</a></li><li><a href="/his-doc/tool/his-request.html">his-request 请求</a></li><li><a href="/his-doc/tool/winning-micro-app-service.html">wms 使用文档</a></li><li><a href="/his-doc/tool/winning-dll.html" aria-current="page" class="router-link-exact-active router-link-active">winning-dll 组件</a></li><li><a href="/his-doc/tool/micro-app.html">@winning/micro-app</a></li><li><a href="/his-doc/tool/hot-key.html">hot-key 热键方案</a></li></ul></aside> <div class="content__default"><h2 id="winning-dll-组件"><a href="#winning-dll-组件" class="header-anchor">#</a> winning-dll 组件</h2> <blockquote><p>集中封装混合框架调用事件DLL方法</p></blockquote> <h3 id="开始使用"><a href="#开始使用" class="header-anchor">#</a> 开始使用</h3> <p>1、安装</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># Install</span>
<span class="token comment"># 将npm源切换为winning</span>
<span class="token function">npm</span> <span class="token function">install</span> winning-dll -S
<span class="token comment"># 或者</span>
<span class="token function">yarn</span> <span class="token function">add</span> winning-dll -S
</code></pre></div><p>2、调用<br></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// getIpAddress 为 winning-dll 内注册事件</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> getIpAddress <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'winning-dll'</span>

<span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getIpAddress</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'IP信息'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span>
</code></pre></div><h3 id="事件注册"><a href="#事件注册" class="header-anchor">#</a> 事件注册</h3> <p>1、 注册事件名</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 打开 ./src/index.js </span>
<span class="token keyword">export</span> <span class="token keyword">const</span> issuingPrint <span class="token operator">=</span> WinningSDK<span class="token punctuation">.</span><span class="token function">issuingPrint</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>WinningSDK<span class="token punctuation">)</span>
</code></pre></div><p>2、 注册事件方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 打开 ./src/core/index.js</span>
<span class="token comment">/**
 * 取消医保正算
 * @param {*} params
 */</span>

<span class="token comment">// 1、只有事件ID</span>
<span class="token keyword">static</span> <span class="token function">cancelInsurSettled</span><span class="token punctuation">(</span><span class="token parameter">params</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">_dispatchEvent</span><span class="token punctuation">(</span><span class="token string">'399309970'</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2、事件ID、事件funcname</span>
<span class="token keyword">static</span> <span class="token function">cancelInsurSettled</span><span class="token punctuation">(</span>params<span class="token punctuation">,</span> name <span class="token operator">=</span> <span class="token string">'cancelInsurSettled'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>instance<span class="token punctuation">.</span><span class="token function">_dispatchEvent</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'399309970'</span><span class="token punctuation">,</span> name<span class="token punctuation">}</span><span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>3、调用</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> WinningDll <span class="token keyword">from</span> <span class="token string">'winning-dll'</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span> success<span class="token punctuation">,</span> errorDetail <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> WinningDll<span class="token punctuation">.</span><span class="token function">cancelInsurSettled</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">login</span><span class="token operator">:</span> operateInfo<span class="token punctuation">,</span>
  setlInsurReimDetailId<span class="token punctuation">,</span>
  medInstiInterfaceId<span class="token punctuation">,</span>
  settlementId
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>success<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 成功</span>
<span class="token punctuation">}</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>success <span class="token operator">||</span> success <span class="token operator">===</span> <span class="token string">'false'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 失败</span>
  <span class="token keyword">throw</span> errorDetail
<span class="token punctuation">}</span>
</code></pre></div><h3 id="已注册事件参数说明"><a href="#已注册事件参数说明" class="header-anchor">#</a> 已注册事件参数说明</h3> <p>1、getMacAddress： 获取Mac地址</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>无</td> <td>无</td> <td>无</td></tr></tbody></table> <p>2、getIpAddress： 获取IP地址</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>无</td> <td>无</td> <td>无</td></tr></tbody></table> <p>3、reconciliation： 支付对账</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th></tr></thead> <tbody><tr><td>loginInfo</td> <td>登陆信息<br> {<br>  hospitalSOID：业务医院SOID<br>  deptId：登录科室标识<br>  operatedBy：操作人员标识<br>  operatorNo：操作人员编码<br>}</td> <td>Entity</td></tr> <tr><td>paymentReconciliationId</td> <td>支付对账单标识</td> <td>Long</td></tr></tbody></table> <p>4、issuingPrint： 票据打印</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>issuingFlag</td> <td>-</td> <td>string</td> <td>98175</td></tr> <tr><td>previewFlag</td> <td>仅预览不打印标志</td> <td>Long</td> <td>-</td></tr> <tr><td>printTemplateId</td> <td>打印模板标识</td> <td>Long</td> <td>-</td></tr> <tr><td>printTemplateName</td> <td>打印模板名称</td> <td>string</td> <td>-</td></tr> <tr><td>printTemplatePath</td> <td>打印模板路径</td> <td>string</td> <td>-</td></tr> <tr><td>printQty</td> <td>打印份数</td> <td>Integer</td> <td>-</td></tr></tbody></table> <p>5、readcard： 读卡</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>identityEntryId</td> <td>-</td> <td></td> <td>string</td></tr> <tr><td>identityEntryName</td> <td></td> <td>string</td> <td>-</td></tr> <tr><td>hospitalSOID</td> <td>业务医院SOID</td> <td>string</td> <td>-</td></tr> <tr><td>identityNo</td> <td>身份标识号码</td> <td>string</td> <td>-</td></tr> <tr><td>applicationCode</td> <td></td> <td>string</td> <td>-</td></tr> <tr><td>identityTypeCode</td> <td></td> <td>Integer</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息<br> {<br>  employeeId：员工标识<br>  employeeName：员工名称<br>  departmentId：<br>  departmentName：<br>ipAddress：IP地址<br>mac：Mac地址<br>medInstiId：<br>medInstiName：<br>}</td> <td>Entity</td> <td>-</td></tr></tbody></table> <p>6、recharge： 充值</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>-</td> <td>-</td> <td>-</td> <td>-</td></tr></tbody></table> <p>7、refund： 退费</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>-</td> <td>-</td> <td>-</td> <td>-</td></tr></tbody></table> <p>8、refundCard： 红冲退卡</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>-</td> <td>-</td> <td>-</td> <td>-</td></tr></tbody></table> <p>9、getOutDInsuranceBudget： 获取门诊医保预算结果</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>settlementId</td> <td>结算单标识</td> <td>Long</td> <td>-</td></tr> <tr><td>setlInsurReimDetailId</td> <td>结算单医保报销交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>10、getRegInsuranceBudget： 获取挂号医保预算结果</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>settlementId</td> <td>结算单标识</td> <td>Long</td> <td>-</td></tr> <tr><td>setlInsurReimDetailId</td> <td>结算单医保报销交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>11、getOutDInsuranceZS： 获取门诊医保正算结果</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>settlementId</td> <td>结算单标识</td> <td>Long</td> <td>-</td></tr> <tr><td>setlInsurReimDetailId</td> <td>结算单医保报销交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>userId、userNo、operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>12、getRegInsuranceZS： 获取挂号医保正算结果</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>settlementId</td> <td>结算单标识</td> <td>Long</td> <td>-</td></tr> <tr><td>setlInsurReimDetailId</td> <td>结算单医保报销交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>userId、userNo、operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>13、toPay： 收银支付</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>paymentId</td> <td>支付明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>txnAmount</td> <td>交易金额</td> <td>Double</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>thirdPartyPaymentTraceId</td> <td>第三方支付交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>14、invoiceInfo：电子发票数量获取</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operatorNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>15、cancelThirdPartyCharge：取消第三方支付</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>thirdPartyPaymentTraceId</td> <td>第三方支付交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>paymentId</td> <td>支付明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>txnAmount</td> <td>交易金额</td> <td>Double</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>accountInfo</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>15、cancelInsurPreSettled：取消医保预算</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>settlementId</td> <td>结算单标识</td> <td>Long</td> <td>-</td></tr> <tr><td>setlInsurReimDetailId</td> <td>结算单医保报销交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>16、cancelInsurSettled：取消医保正算</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>settlementId</td> <td>结算单标识</td> <td>Long</td> <td>-</td></tr> <tr><td>setlInsurReimDetailId</td> <td>结算单医保报销交易明细标识</td> <td>Long</td> <td>-</td></tr> <tr><td>medInstiInterfaceId</td> <td>医疗机构的接口标识</td> <td>Long</td> <td>-</td></tr> <tr><td>login</td> <td>登陆信息：<br>operatedBy、operateEmployeeNo、hospitalSOID、deptId</td> <td>-</td> <td>-</td></tr></tbody></table> <p>17、generateSettlementPic：结账单图片生成</p> <table><thead><tr><th>参数</th> <th>说明</th> <th>类型</th> <th>默认值</th></tr></thead> <tbody><tr><td>-</td> <td>-</td> <td>-</td> <td>-</td></tr></tbody></table></div></main> <footer class="doc-footer"></footer></section><div class="global-ui"></div></div>
    <script src="/his-doc/assets/js/app.2773af9d.js" defer></script><script src="/his-doc/assets/js/2.f33ebbea.js" defer></script><script src="/his-doc/assets/js/26.4369cb56.js" defer></script>
  </body>
</html>
